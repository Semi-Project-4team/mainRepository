<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>동물병원플러스입니다.</title>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/footer.css">
</head>
<body>

<div th:insert="~{common/header.html}"></div> <!-- 헤더 포함 -->

    <!--공지사항-->
<div class="main">
    <div class="search-wrap">


<div class="notice">
    <h3>
        <a id="noticeList" href="/notice/list">[공지사항] </a>
        <a id="noticeLink" class="noticeLink" th:attr="data-code=${noticeList[0].code}" th:text="${noticeList[0].name}"></a>
    </h3>
</div>

<!-- Thymeleaf에서 JSON으로 변환된 noticeList를 JavaScript에 전달 -->

<script th:inline="javascript">
    // noticeList를 JSON 배열로 변환하여 JavaScript로 전달
    const noticeList = /*[[${noticeList}]]*/ [];

    const noticeLinks = [];

    // 공지사항 목록을 배열에 저장
    noticeList.forEach((notice) => {
        noticeLinks.push({
            code: notice.code,  // 공지사항 코드
            text: notice.name   // 공지사항 이름
        });
    });

    let currentIndex = 0;

    // 처음 제목을 즉시 표시
    mainNotice();

    // 공지사항을 5초마다 변경
    const intervalId = setInterval(() => {
        currentIndex = (currentIndex + 1) % noticeLinks.length; // 인덱스 증가 및 순환
        mainNotice();
    }, 5000);

    function mainNotice() {
        // 현재 인덱스에 해당하는 공지사항 정보를 가져옴
        const notice = noticeLinks[currentIndex];

        // 링크 텍스트와 href를 업데이트
        document.getElementById('noticeLink').textContent = notice.text; // 제목 변경
        document.getElementById('noticeLink').href = `/notice/detail/${notice.code}`; // 링크 변경

    }
</script>


    <!--병원찾기-->
    <div class="search-hospital">
        <br>
        <button class="button" onclick="openPopup()">지역별 동물병원찾기</button>
        <br><img
            src="../../../../../../../../../../var/folders/w2/nq7zbvj527lfmmk8js20y40r0000gn/T/TemporaryItems/NSIRD_screencaptureui_uzLJfw/스크린샷 2024-09-30 오후 12.10.05.png"
            height="624" width="650"/>
        <br>
        <button class="button" onclick="location.href='/hospital/info/list'">동물병원 전체목록</button>
        <script>
            function openPopup() {
                window.open('hospital/sidoAll', 'hospital/info/sigungu/', 'width=600,height=400,scrollbars=yes');
                window.close('hospital/info/eupmyeondong');
            }
        </script>
        <br>
        <br>
        <form action="/search" method="GET">
            <input type="text" id="search" name="query" placeholder="지역 또는 병원이름을 직접 검색">
            <br>
            <br>
            <button type="submit">검색</button>
        </form>
        <br>
        <br>

        <!-- Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="close" style="cursor: pointer;">&times;</span>
                <h2>병원 찾기</h2>
                <select id="sido" name="sido" onchange="loadSigungu(this.value)">
                    <option value="0">시/도</option>
                    <!-- 시/도 목록 서버에서 동적으로 생성 -->
                </select>

                <select id="sigungu" onchange="loadEupMyeonDong(this.value)" disabled>
                    <option value="">시/군/구</option>
                </select>

                <select id="eupmyeondong" onclick="redirectToHospitalList(this.value)" disabled>
                    <option value="">읍/면/동</option>
                </select>
<!--                <button onclick="redirectToHospitalList()">선택</button>-->
            </div>
        </div>

        <script>
            function redirectToHospitalList() {
                document.getElementById('myModal').style.display = 'none';
                // 선택된 읍/면/동 코드가 있으면 병원 목록 페이지로 리다이렉트
                window.location.href = '/hospital/info/list/' + eupmyeondongCode;
            }
        </script>

    </div>
    </div>
</div>

<div th:insert="~{common/footer.html}"></div> <!-- 푸터 포함 -->


    <script>
        function updateLabel() {
            const sidoName = document.getElementById("sido").selectedOptions[0].text;
            const sigunguName = document.getElementById("sigungu").selectedOptions[0]?.text || '';
            const eupmyeondongName = document.getElementById("eupmyeondong").selectedOptions[0]?.text || '';

            const selectedRegionLabel = `${sidoName} > ${sigunguName} > ${eupmyeondongName}`;
            document.getElementById("selectedRegion").textContent = selectedRegionLabel;
        }
    </script>
</div>
</body>
</html>